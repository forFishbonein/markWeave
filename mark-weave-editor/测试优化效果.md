# 性能优化效果测试指南

## 🚀 立即测试优化效果

### 1. 启动系统
```bash
# 确保OT服务器运行
cd editor-yjs-server
npm run ot-server

# 启动前端 (新终端)
cd mark-weave-editor
npm start
```

### 2. 访问对比页面
```
http://localhost:3000/algorithm-comparison-lab
```

### 3. 开启性能调试 (可选)
在浏览器控制台执行：
```javascript
// 启用性能调试器
enablePerformanceDebug();

// 5秒后查看统计信息会自动输出
// 或手动查看: getPerformanceDebugInfo();
```

### 4. 测试数据更新速度
1. **点击"开始对比"**
2. **在左侧CRDT编辑器输入**: `测试CRDT性能优化效果123`
3. **在右侧OT编辑器输入**: `测试OT性能优化效果456`
4. **观察数据更新速度** - 应该在150ms内看到变化

### 5. 测试多窗口优化
1. **点击"多窗口测试"**
2. **在新窗口中也进行输入**
3. **观察两个窗口的数据同步** - 应该在250-300ms内同步

## 📊 验证指标

### 优化前 vs 优化后对比
| 测试项目 | 优化前 | 优化后 | 改善 |
|---------|-------|-------|------|
| UI数据更新 | 500ms | 150ms | 70%↑ |
| 多窗口同步 | 1000ms | 250-300ms | 70%↑ |
| 操作响应感受 | 明显延迟 | 接近实时 | 显著改善 |

### 检查要点
- ✅ 输入文字后立即看到"操作总数"增加
- ✅ 延迟数据在150ms内更新
- ✅ 多窗口协作数据快速同步
- ✅ 实时对比结果快速变化
- ✅ 控制台无错误信息

## 🔍 故障排除

### 如果数据更新仍然缓慢
1. **硬刷新页面**: Ctrl+F5 (Windows) 或 Cmd+Shift+R (Mac)
2. **检查控制台**: 查看是否有错误信息
3. **确保监控启动**: 两个编辑器都显示"已连接"状态
4. **重新开始对比**: 点击"重置全部" → "开始对比"

### 如果OT编辑器未连接
1. **检查OT服务器**: 确保端口1235正在监听
2. **重启OT服务器**: Ctrl+C 后重新运行 `npm run ot-server`
3. **检查防火墙**: 确保端口1235未被阻止

## 📈 性能基准测试

### 建议测试场景
1. **单窗口基础测试**: 连续输入20个字符，观察响应速度
2. **多窗口协作测试**: 两个窗口同时编辑，观察同步效果
3. **高频操作测试**: 快速连续输入，观察系统稳定性
4. **长时间监控测试**: 运行10分钟，观察性能一致性

### 期望结果
- 🎯 **用户输入 → 150ms → 数据显示**
- 🎯 **窗口A操作 → 300ms → 窗口B同步**
- 🎯 **连续操作响应流畅无卡顿**
- 🎯 **长时间运行性能稳定**

## 🎉 验证成功标志

当您看到以下现象时，说明优化已成功：
- ⚡ 输入后立即看到指标变化
- ⚡ 对比数据快速更新
- ⚡ 多窗口协作感觉流畅
- ⚡ 总体响应速度明显提升

## 💡 提示

- 在控制台执行 `enablePerformanceDebug()` 可以看到详细的更新统计
- 如有问题，控制台会显示详细的调试信息
- 优化后的系统更适合进行学术级的性能对比实验
