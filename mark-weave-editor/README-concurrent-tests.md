# å¹¶å‘æ’å…¥æµ‹è¯•ç»“æœå¯¼å‡º

æœ¬é¡¹ç›®æä¾›äº†ä¾¿æ·çš„æ–¹å¼æ¥è¿è¡Œç°æœ‰çš„ `tests/crdt/concurrent.test.js` æ–‡ä»¶ä¸­çš„å¹¶å‘æ’å…¥æµ‹è¯•ï¼Œå¹¶å°†ç»“æœä¿å­˜åˆ°Markdownæ–‡ä»¶ä¸­ã€‚

## ä½¿ç”¨æ–¹æ³•

### æ–¹æ³•1ï¼šä½¿ç”¨npmè„šæœ¬ï¼ˆæ¨èï¼‰

```bash
# è¿è¡Œ tests/crdt/concurrent.test.js ä¸­çš„å¹¶å‘æ’å…¥æµ‹è¯•å¹¶ä¿å­˜ç»“æœ
npm run test:concurrent:save
```

### æ–¹æ³•2ï¼šä½¿ç”¨shellè„šæœ¬

```bash
# è¿è¡Œshellè„šæœ¬
./run-concurrent-tests.sh
```

### æ–¹æ³•3ï¼šåªè¿è¡Œæµ‹è¯•ï¼ˆä¸ä¿å­˜ï¼‰

```bash
# åªè¿è¡Œ tests/crdt/concurrent.test.js ä¸­çš„å¹¶å‘æ’å…¥æµ‹è¯•å¥—ä»¶
npm run test:concurrent
```

### æ–¹æ³•4ï¼šæ‰‹åŠ¨ä¿å­˜

```bash
# æ‰‹åŠ¨è¿è¡Œå¹¶ä¿å­˜åˆ°æŒ‡å®šæ–‡ä»¶
npm run test:concurrent > my-test-results.md 2>&1
```

## æµ‹è¯•æºæ–‡ä»¶

- **æµ‹è¯•æ–‡ä»¶**: `tests/crdt/concurrent.test.js`
- **æµ‹è¯•å¥—ä»¶**: `å¹¶å‘æ’å…¥å®Œæ•´æµ‹è¯•å¥—ä»¶`
- **è¿è¡Œå‘½ä»¤**: `npm run test:crdt -- --testNamePattern="å¹¶å‘æ’å…¥å®Œæ•´æµ‹è¯•å¥—ä»¶"`

## è¾“å‡ºæ–‡ä»¶

- **ä½ç½®**: `test-results/` ç›®å½•
- **å‘½åæ ¼å¼**: `concurrent-test-YYYY-MM-DDTHH-MM-SS.md`
- **å†…å®¹åŒ…æ‹¬**:
  - å®Œæ•´çš„æµ‹è¯•è¾“å‡ºï¼ˆæ¥è‡ª `tests/crdt/concurrent.test.js`ï¼‰
  - æµ‹è¯•åˆ†æå’Œæ€»ç»“
  - å…³é”®ä¿®å¤éªŒè¯çŠ¶æ€

## æµ‹è¯•å¥—ä»¶å†…å®¹

`tests/crdt/concurrent.test.js` ä¸­çš„"å¹¶å‘æ’å…¥å®Œæ•´æµ‹è¯•å¥—ä»¶"åŒ…å«ä»¥ä¸‹8ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼š

1. **åŸºç¡€å¹¶å‘æ’å…¥** - ä¸¤å®¢æˆ·ç«¯å¼€å¤´åŒæ—¶æ’å…¥
2. **ä¸­é—´ä½ç½®å¹¶å‘æ’å…¥** - åœ¨æŒ‡å®šå­—ç¬¦ååŒæ—¶æ’å…¥ âœ… **æ ¸å¿ƒä¿®å¤éªŒè¯**
3. **å¤šå­—ç¬¦å¹¶å‘æ’å…¥** - ä½¿ç”¨insertText
4. **ä¸‰å®¢æˆ·ç«¯å¹¶å‘æ’å…¥** - å¤æ‚å¹¶å‘åœºæ™¯
5. **è¿ç»­å¹¶å‘æ’å…¥** - æ¨¡æ‹Ÿå¿«é€Ÿè¾“å…¥
6. **æ··åˆæ“ä½œå¹¶å‘** - æ’å…¥+åˆ é™¤+æ ¼å¼åŒ–
7. **è¾¹ç•Œæƒ…å†µ** - ç©ºæ–‡æ¡£å¹¶å‘æ’å…¥
8. **æ—¶é—´æˆ³åˆ†æ** - éªŒè¯æ’åºè§„åˆ™

## å…³é”®ä¿®å¤éªŒè¯

è¿™äº›æµ‹è¯•ç‰¹åˆ«éªŒè¯äº†ä»¥ä¸‹å…³é”®ä¿®å¤ï¼š

- âœ… å­—ç¬¦æ­£ç¡®æ’å…¥åœ¨afterIdæŒ‡å®šä½ç½®ï¼ˆè€Œä¸æ˜¯æ–‡æ¡£æœ«å°¾ï¼‰
- âœ… æ—¶é—´æˆ³æ’åºæ­£å¸¸å·¥ä½œï¼ˆåæ’å…¥çš„æ’åœ¨åé¢ï¼‰
- âœ… å¹¶å‘æ’å…¥è¡Œä¸ºä¸€è‡´ä¸”å¯é¢„æµ‹
- âœ… å®¢æˆ·ç«¯éš”ç¦»æœºåˆ¶æ­£å¸¸å·¥ä½œ

## ç¤ºä¾‹è¾“å‡º

```
ğŸ§ª å¼€å§‹è¿è¡Œå¹¶å‘æ’å…¥æµ‹è¯•å¥—ä»¶...
ğŸ“ ç»“æœå°†ä¿å­˜åˆ°: test-results/concurrent-test-2025-07-12T22-16-41.md

[è¿è¡Œ tests/crdt/concurrent.test.js æµ‹è¯•è¿‡ç¨‹...]

==================================================
âœ… æµ‹è¯•å®Œæˆï¼
ğŸ“„ ç»“æœå·²ä¿å­˜åˆ°: test-results/concurrent-test-2025-07-12T22-16-41.md
ğŸ“Š æ–‡ä»¶å¤§å°: 23.18 KB
ğŸ“ æµ‹è¯•çš„æ˜¯ç°æœ‰æ–‡ä»¶: tests/crdt/concurrent.test.js
```

## æ–‡ä»¶ç»“æ„

```
mark-weave-editor/
â”œâ”€â”€ tests/crdt/
â”‚   â””â”€â”€ concurrent.test.js          # æºæµ‹è¯•æ–‡ä»¶ï¼ˆè¢«è¿è¡Œçš„æµ‹è¯•ï¼‰
â”œâ”€â”€ test-results/                   # æµ‹è¯•ç»“æœè¾“å‡ºç›®å½•
â”‚   â””â”€â”€ concurrent-test-*.md        # ç”Ÿæˆçš„æµ‹è¯•ç»“æœæ–‡ä»¶
â”œâ”€â”€ save-concurrent-tests.js        # Node.jsæµ‹è¯•è¿è¡Œè„šæœ¬
â”œâ”€â”€ run-concurrent-tests.sh         # Shellæµ‹è¯•è¿è¡Œè„šæœ¬
â””â”€â”€ package.json                    # åŒ…å«npmè„šæœ¬é…ç½®
```

## æ ¸å¿ƒä¿®å¤å±•ç¤º

ç”Ÿæˆçš„æŠ¥å‘Šå°†å±•ç¤ºå…³é”®ä¿®å¤éªŒè¯ï¼š

```markdown
### é‡è¦ç»“æœæ‘˜è¦
âœ… **æ ¸å¿ƒé—®é¢˜å·²ä¿®å¤**: å­—ç¬¦ç°åœ¨æ­£ç¡®æ’å…¥åœ¨ä¸‹åˆ’çº¿åï¼Œ
æ ¼å¼ä¸º `start_XYend` è€Œä¸æ˜¯ä¹‹å‰é”™è¯¯çš„ `start_endXY`
```

## æ•…éšœæ’é™¤

å¦‚æœé‡åˆ°é—®é¢˜ï¼š

1. ç¡®ä¿æ‰€æœ‰ä¾èµ–å·²å®‰è£…ï¼š`npm install`
2. ç¡®ä¿ç°æœ‰æµ‹è¯•æ–‡ä»¶å­˜åœ¨ï¼š`ls tests/crdt/concurrent.test.js`
3. ç¡®ä¿æµ‹è¯•ç¯å¢ƒæ­£å¸¸ï¼š`npm run test:crdt`
4. æ£€æŸ¥æƒé™ï¼š`chmod +x run-concurrent-tests.sh`
5. æŸ¥çœ‹è¯¦ç»†é”™è¯¯ï¼šæ·»åŠ  `--verbose` å‚æ•°