@startuml
skinparam componentStyle rectangle
skinparam packageStyle rectangle

title MarkWeave Collaborative Editor - System Architecture

actor "Users" as users

package "Frontend" {
  component "React App" as frontend {
    [Authentication]
    [Team Management]
    [Document List]
    [Real-time Editor]
  }
}

package "Backend Server" {
  component "Express.js API" as api {
    [Auth Routes]
    [Team Routes]
    [Document Routes]
  }

  component "WebSocket Server" as ws {
    [Yjs Provider]
    [Real-time Sync]
  }
}

package "Data Storage" {
  database "MongoDB" as db {
    [Users Collection]
    [Teams Collection]
    [Documents Collection]
    [CRDT States]
  }
}

cloud "External Services" {
  component "JWT Service" as jwt
}

' User interactions
users --> frontend : "Web Browser"

' Frontend to Backend
frontend --> api : "HTTP/REST API"
frontend --> ws : "WebSocket Connection"

' Backend to Database
api --> db : "CRUD Operations"
ws --> db : "State Persistence"

' External services
api --> jwt : "Token Generation"

' Real-time collaboration flow
frontend <--> ws : "Document Sync"

note right of frontend
  **Technologies:**
  - React + Ant Design
  - ProseMirror Editor
  - Yjs CRDT Client
end note

note right of api
  **Features:**
  - JWT Authentication
  - Team Management
  - Document CRUD
  - Permission Control
end note

note right of ws
  **Real-time:**
  - Collaborative Editing
  - Conflict Resolution
  - User Awareness
end note

note right of db
  **Storage:**
  - User Data
  - Team Data
  - Document Content
  - Binary CRDT States
end note

@enduml